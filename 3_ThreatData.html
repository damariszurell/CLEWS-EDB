<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Species threats</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecosystem dynamics and biodiversity</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: Spatial data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="0_setup.html">0. Getting started</a>
    </li>
    <li>
      <a href="1_SpatialData.html">1. Spatial data in R</a>
    </li>
    <li>
      <a href="2_BiodivData.html">2. Biodiversity data in R</a>
    </li>
    <li>
      <a href="3_ThreatData.html">3. Threat data in R</a>
    </li>
    <li>
      <a href="4_EnvData.html">4. Environmental data in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: Species distribution models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="5_SDM_intro.html">5. SDMs: simple model fitting</a>
    </li>
    <li>
      <a href="6_SDM_eval.html">6. SDMs: assessment and prediction</a>
    </li>
    <li>
      <a href="7_SDM_algorithms.html">7. SDMs: algorithms and ensembles</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: population modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="8_RS_intro.html">8. Getting started with RangeShiftR</a>
    </li>
    <li>
      <a href="9_RS_lynx.html">9. RangeShiftR: Eurasian lynx reintroduction</a>
    </li>
    <li>
      <a href="10_RS_grouse.html">10. RangeShiftR: Black grouse range dynamics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: ecosystem modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="11_Mad_intro.html">11. Running MadingleyR</a>
    </li>
    <li>
      <a href="12_Mad_carnivores.html">12. MadingleyR: Role of large carnivores</a>
    </li>
    <li>
      <a href="13_Mad_landuse.html">13. MadingleyR: land use change effects</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.uni-potsdam.de/en/ibb-macroecology/index">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ZurellLab">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Species threats</h1>

</div>


<hr />
<div class="alert alert-info">
<p><strong>RStudio project</strong></p>
<p>Open the RStudio project that we created in the first session. I
recommend to use this RStudio project for the entire course and within
the RStudio project create separate R scripts for each session.</p>
<ul>
<li>Create a new empty R script by going to the tab “File”, select “New
File” and then “R script”</li>
<li>In the new R script, type
<code># Session 3: Species threat data</code> and save the file in your
folder “scripts” within your project folder, e.g. as
“3_ThreatData.R”</li>
</ul>
</div>
<p>The IUCN Red List of threatened species is a useful resource when
analysing diversity changes, species range changes and population
changes: www.iucnredlist.org <span class="citation">(IUCN 2019)</span>.
It provides information on the global conservation status of species,
specifically of animals, fungi and plant species. The IUCN has defined a
set of criteria to evaluate the extinction risk of species. According to
these criteria, species are classified into nine different categories
although strictly only five categories describe the conservation status
- from least concern to critically endangered [Fig. 1; <span
class="citation">IUCN (2012)</span>].</p>
<p><img src="figures/redlist.png" title="**Figure 1. The IUCN red list categories. Adapted from [@IUCN2012].**" alt="**Figure 1. The IUCN red list categories. Adapted from [@IUCN2012].**" width="70%" /></p>
<p>The IUCN distinguishes five criteria that are used to classify
species into one of the three threatened categories (Fig. 1; <span
class="citation">IUCN (2012)</span>):</p>
<ul>
<li>A. Population size reduction</li>
<li>B. Extent of occurrence (B1) or Area of occupancy (B2)</li>
<li>C. Small population size and decline</li>
<li>D. Very small or restricted population</li>
<li>E. Quantitative analysis (probability of extinction within next 100
years)</li>
</ul>
<p>All of this information (the red list category, the relevant
assessment criteria, the population trends, etc.) are provided by the
IUCN. We can look at all these information online, e.g. for the <a
href="https://www.iucnredlist.org/species/12519/121707666">Eurasian
lynx</a>.</p>
<p>Of course, if you want to analyse your species data in light of these
IUCN assessments, it can become very tedious to look up all information
by hand. The IUCN red list team provides an API for this purpose, and
the R package <code>rredlist</code> is a client to access this <a
href="http://apiv3.iucnredlist.org/api/v3/docs">IUCN red list API</a>.
It requires an <a href="http://apiv3.iucnredlist.org/api/v3/docs">API
key / a token</a> to use the API. You have to indicate your research
objectives for using the API.</p>
<div id="data" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Data</h1>
<div id="mammal-data" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Mammal data</h2>
<p>We will work with European mammals. The distribution data come from
the IUCN range maps from practical 2 that I rasterised to European
extent. Course participants can download the data from the moodle page
(store in your <em>data</em> folder). For completeness, I show the code
below for compiling the data.</p>
<pre class="r"><code># Read in mammal shapefile
mammals &lt;- shapefile(&#39;data/MAMMTERR.shp&#39;)

# rough European extent
extent_eur &lt;- c(-15,45,35,72)

# Crop SpatialPolygonsDataFrame to European extent
mammals_eur &lt;- crop(mammals, extent_eur)

# Rasterise mammal range maps for European extent
r_mammals_eur &lt;- lets.presab(mammals_eur, resol=1, presence = 1, origin = 1, seasonal = 1)

# Save the PresenceAbsence object
save(extent_eur, r_mammals_eur,file=&#39;data/r_mammals_eur.RData&#39;)</code></pre>
<p>Load the <code>PresenceAbsence</code> object:</p>
<pre class="r"><code>load(&#39;data/r_mammals_eur.RData&#39;)

# Remember how the PresenceAbsence objects look like:
str(r_mammals_eur,2)</code></pre>
<pre><code>## List of 3
##  $ Presence_and_Absence_Matrix: num [1:1491, 1:293] -14.5 -13.5 -12.5 -11.5 -10.5 -9.5 -8.5 -7.5 -6.5 -5.5 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ Richness_Raster            :</code></pre>
<pre><code>## Loading required package: raster</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## Formal class &#39;RasterLayer&#39; [package &quot;raster&quot;] with 12 slots
##  $ Species_name               : chr [1:291] &quot;Acomys cilicicus&quot; &quot;Acomys minous&quot; &quot;Alces alces&quot; &quot;Allactaga elater&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;PresenceAbsence&quot;</code></pre>
<pre class="r"><code># Plot the richness raster:
plot(crop(r_mammals_eur$Richness_Raster,extent_eur))</code></pre>
<p><img src="3_ThreatData_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>For merging the mammal distribution with the red list data, we will
need the species names:</p>
<pre class="r"><code># Extract the species names from the PresenceAbsence object
names_mammals_eur &lt;- colnames(r_mammals_eur$Presence_and_Absence_Matrix)[-c(1:2)]</code></pre>
</div>
<div id="iucn-red-list-data" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> IUCN Red list
data</h2>
<p>Course participants can download the data
(<em>mammals_eur_redlist_status.csv</em> and
<em>mammals_eur_redlist_threats.csv</em>) in the secured moodle folder
(but please be aware that the <a
href="https://www.iucnredlist.org/terms/terms-of-use">IUCN terms of
use</a> apply!). External readers are advised to generate an API
token:</p>
<pre class="r"><code>library(rredlist)

# Generate your personal API token
rl_use_iucn()</code></pre>
<div id="iucn-red-list-status" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> IUCN red list
status</h3>
<p>If you have your own IUCN API key, you can easily download the
information on species’ red list categories:</p>
<pre class="r"><code># Download red list category for single species using your personal API token &quot;MY_IUCN_REDLIST_KEY&quot;
(rl_search(&#39;Lynx lynx&#39;, key= MY_IUCN_REDLIST_KEY))</code></pre>
<pre><code>## $name
## [1] &quot;Lynx lynx&quot;
## 
## $result
##   taxonid scientific_name  kingdom   phylum    class     order  family genus
## 1   12519       Lynx lynx ANIMALIA CHORDATA MAMMALIA CARNIVORA FELIDAE  Lynx
##   main_common_name        authority published_year assessment_date category
## 1    Eurasian Lynx (Linnaeus, 1758)           2015      2014-04-20       LC
##   criteria population_trend marine_system freshwater_system terrestrial_system
## 1       NA           Stable         FALSE             FALSE               TRUE
##                                                                                                 assessor
## 1 Breitenmoser, U., Breitenmoser-Würsten, C., Lanz, T., von Arx, M., Antonevich, A., Bao, W. &amp; Avgan, B.
##                              reviewer aoo_km2  eoo_km2 elevation_upper
## 1 Nowell, K., Hunter, L. &amp; Mallon, D.      NA 42765298            5500
##   elevation_lower depth_upper depth_lower errata_flag
## 1               0          NA          NA        TRUE
##                                                                                                                               errata_reason
## 1 An errata version of the original assessment has been published to correct the typo &quot;Mmountain Hares&quot; which should read &quot;Mountain Hares&quot;.
##   amended_flag amended_reason
## 1           NA             NA</code></pre>
<pre class="r"><code># Download red list categories for all species
redlist_status &lt;- do.call(rbind,lapply(names_mammals_eur,FUN=function(sp){
  rl_search(sp, key= MY_IUCN_REDLIST_KEY)$result
  }
  ))</code></pre>
<p>Course participants can download the data from moodle and read it
in:</p>
<pre class="r"><code>redlist_status &lt;- read.table(&#39;data/mammals_eur_redlist_status.csv&#39;, header=T, sep=&#39;;&#39;)</code></pre>
<p>Here is an example of the kind of information in the table. Compare
this to the information given on the IUCN website, e.g. for the <a
href="https://www.iucnredlist.org/species/12519/121707666">Eurasian
Lynx</a>.</p>
<pre class="r"><code>redlist_status[1:10,10:20]</code></pre>
<pre><code>##               authority published_year assessment_date category criteria
## 1   Spitzenberger, 1978           2019      2017-05-22       DD     &lt;NA&gt;
## 2            Bate, 1906           2019      2017-05-22       DD     &lt;NA&gt;
## 3      (Linnaeus, 1758)           2016      2015-09-27       LC     &lt;NA&gt;
## 4  (Lichtenstein, 1825)           2016      2016-09-08       LC     &lt;NA&gt;
## 5          Thomas, 1881           2019      2019-07-09       LC     &lt;NA&gt;
## 6          (Kerr, 1792)           2016      2016-09-08       LC     &lt;NA&gt;
## 7          Thomas, 1897           2016      2016-09-09       LC     &lt;NA&gt;
## 8        (Pallas, 1777)           2021      2020-08-26       VU       C1
## 9        (Pallas, 1771)           2016      2016-09-08       LC     &lt;NA&gt;
## 10       Heinrich, 1952           2016      2016-09-09       LC     &lt;NA&gt;
##    population_trend marine_system freshwater_system terrestrial_system
## 1           Unknown         FALSE             FALSE               TRUE
## 2           Unknown         FALSE             FALSE               TRUE
## 3        Increasing         FALSE             FALSE               TRUE
## 4        Decreasing         FALSE             FALSE               TRUE
## 5        Decreasing         FALSE             FALSE               TRUE
## 6        Decreasing         FALSE             FALSE               TRUE
## 7        Decreasing         FALSE             FALSE               TRUE
## 8        Decreasing         FALSE             FALSE               TRUE
## 9            Stable         FALSE             FALSE               TRUE
## 10          Unknown         FALSE             FALSE               TRUE
##                                                                                                                  assessor
## 1                                                                                              Gerrie, R. &amp; Kennerley, R.
## 2                                                                                              Gerrie, R. &amp; Kennerley, R.
## 3                                                                                                         Hundertmark, K.
## 4                Shenbrot, G., Tsytsulina, K., Batsaikhan, N., Avirmed, D., Tinnin, D., Sukhchuluun, G &amp; Lkhagvasuren, D.
## 5                                                                                               Dando, T. &amp; Kennerley, R.
## 6                                                             Tsytsulina, K., Formozov, N., Zagorodnyuk, I. &amp; Sheftel, B.
## 7                                                                                      Eken, G., Bozdogan, M. &amp; Molur, S.
## 8  Cassinello, J., Bounaceur, F., Brito, J.C., Bussière, E., Cuzin, F., Gil-Sánchez, J., Herrera-Sánchez, F. &amp; Wacher, T.
## 9                Kaneko, Y., Kryštufek, B., Zagarondnyuk, I., Vohralík, V., Batsaikhan, N., Avirmed, D. &amp; Sukhchuluun, G.
## 10                                                                                                             Meinig, H.
##                      reviewer
## 1                   Amori, G.
## 2                   Amori, G.
## 3  Brook, S.M. &amp; McShea, W.J.
## 4                   Amori, G.
## 5                   Amori, G.
## 6                   Amori, G.
## 7                   Amori, G.
## 8    Herrero, J. &amp; Michel, S.
## 9                   Amori, G.
## 10                  Amori, G.</code></pre>
<p>We can now look at how many mammal species are listed in the
different red list categories or many species have declining, stable or
increasing population trends:</p>
<pre class="r"><code># Conservation status
table(redlist_status$category)</code></pre>
<pre><code>## 
##  CR  DD  EN  LC  NT  VU 
##   7  12  10 213  18  21</code></pre>
<pre class="r"><code># Population trends
table(redlist_status$population_trend)</code></pre>
<pre><code>## 
## Decreasing Increasing     Stable    Unknown 
##         76          8        102         95</code></pre>
</div>
<div id="iucn-red-list-threats" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> IUCN red list
threats</h3>
<p>The IUCN also assesses the main threats per species as you saw in the
<a href="https://www.iucnredlist.org/species/12519/121707666">Eurasian
lynx</a> example. The Threat Classification Scheme can be found <a
href="https://www.iucnredlist.org/resources/threat-classification-scheme">here</a>.</p>
<p>If you have your own IUCN API key, you can easily download the
information on species’ red list threats:</p>
<pre class="r"><code># Download red list threats for single species
rl_threats(&#39;Lynx lynx&#39;, key= MY_IUCN_REDLIST_KEY)</code></pre>
<pre><code>## $name
## [1] &quot;Lynx lynx&quot;
## 
## $result
##     code                                                         title  timing
## 1    2.1                           Annual &amp; perennial non-timber crops Ongoing
## 2  2.1.2                                          Small-holder farming Ongoing
## 3  2.1.3                                         Agro-industry farming Ongoing
## 4    2.2                                       Wood &amp; pulp plantations Ongoing
## 5  2.2.1                                      Small-holder plantations Ongoing
## 6  2.2.2                                     Agro-industry plantations Ongoing
## 7    2.3                                  Livestock farming &amp; ranching Ongoing
## 8  2.3.1                                               Nomadic grazing Ongoing
## 9  2.3.2                     Small-holder grazing, ranching or farming Ongoing
## 10 2.3.3                    Agro-industry grazing, ranching or farming Ongoing
## 11   3.2                                            Mining &amp; quarrying Ongoing
## 12   4.1                                             Roads &amp; railroads Ongoing
## 13   5.1                        Hunting &amp; trapping terrestrial animals Ongoing
## 14 5.1.1                       Intentional use (species is the target) Ongoing
## 15 5.1.2             Unintentional effects (species is not the target) Ongoing
## 16 5.1.3                                           Persecution/control Ongoing
## 17   5.3                                     Logging &amp; wood harvesting Ongoing
## 18 5.3.5                                 Motivation Unknown/Unrecorded Ongoing
## 19   8.1 Invasive non-native/alien species/diseases (Canis familiaris) Ongoing
## 20 8.1.2                              Named species (Canis familiaris) Ongoing
##              scope            severity         score         invasive
## 1             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 2             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 3             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 4             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 5             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 6             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 7             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 8             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 9             &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 10            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 11            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 12            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 13            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 14            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 15            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 16            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 17            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 18            &lt;NA&gt;                &lt;NA&gt; Low Impact: 3             &lt;NA&gt;
## 19 Minority (&lt;50%) Negligible declines Low Impact: 4 Canis familiaris
## 20 Minority (&lt;50%) Negligible declines Low Impact: 4 Canis familiaris</code></pre>
<pre class="r"><code># Download red list threats for all species
redlist_threats &lt;- do.call(rbind,
                           lapply(seq_len(length(names_mammals_eur)),FUN=function(i){
                             xi &lt;- rl_threats(names_mammals_eur[i], key= MY_IUCN_REDLIST_KEY); 
                             if(length(xi$result)) {
                               data.frame(species=names_mammals_eur[i],xi$result) 
                               }
                             }
                             ))</code></pre>
<p>Course participants can download the data from moodle and read it
in:</p>
<pre class="r"><code>redlist_threats &lt;- read.table(&#39;data/mammals_eur_redlist_threats.csv&#39;, header=T, sep=&#39;;&#39;)</code></pre>
<p>The threats are ordered hierarchically from broad threat type to very
detailed threat, e.g.:</p>
<ul>
<li><em>2 Agriculture &amp; aquaculture</em> &gt; <em>2.2 Wood &amp;
pulp plantations </em> &gt; <em>2.2.1 Small-holder plantations</em></li>
<li><em>5 Biological resource use</em> &gt; <em>5.4 Fishing &amp;
harvesting aquatic resources</em> &gt; <em>5.4.3 Unintentional effects:
subsistence/small scale (species being assessed is not the
target)[harvest]</em></li>
</ul>
<p>Here is an example of the kind of information in the table. For more
details, please have a look at the IUCN website, e.g. the <a
href="https://www.iucnredlist.org/species/12519/121707666">Eurasian
lynx</a> example, and at the <a
href="https://www.iucnredlist.org/resources/threat-classification-scheme">Threat
Classification Scheme</a>.</p>
<pre class="r"><code>redlist_threats[sample(nrow(redlist_threats),10),-c(1:2)]</code></pre>
<pre><code>##                                          title  timing             scope
## 1109                        Oil &amp; gas drilling Ongoing   Minority (&lt;50%)
## 296  Abstraction of ground water (unknown use) Ongoing Majority (50-90%)
## 102                  Logging &amp; wood harvesting Ongoing   Minority (&lt;50%)
## 967                  Diseases of unknown cause Ongoing Majority (50-90%)
## 920                          Roads &amp; railroads Ongoing              &lt;NA&gt;
## 434                        Persecution/control Ongoing Majority (50-90%)
## 75            Named species (Myocastor coypus) Ongoing              &lt;NA&gt;
## 48                       Housing &amp; urban areas Ongoing              &lt;NA&gt;
## 943                 Named species (Ovis aries) Ongoing              &lt;NA&gt;
## 422                              Other impacts  Future      Whole (&gt;90%)
##                        severity            score         invasive
## 1109        Negligible declines    Low Impact: 4             &lt;NA&gt;
## 296  Slow, Significant Declines Medium Impact: 6             &lt;NA&gt;
## 102  Slow, Significant Declines    Low Impact: 5             &lt;NA&gt;
## 967              Rapid Declines Medium Impact: 7             &lt;NA&gt;
## 920                        &lt;NA&gt;    Low Impact: 3             &lt;NA&gt;
## 434         Very Rapid Declines   High Impact: 8             &lt;NA&gt;
## 75                         &lt;NA&gt;    Low Impact: 3 Myocastor coypus
## 48                         &lt;NA&gt;    Low Impact: 3             &lt;NA&gt;
## 943                        &lt;NA&gt;    Low Impact: 3       Ovis aries
## 422                     Unknown          Unknown             &lt;NA&gt;</code></pre>
<p>We can extract many useful information from this table, for example,
when specific threats occurred.</p>
<pre class="r"><code>table(redlist_threats$timing)</code></pre>
<pre><code>## 
##                   Future                  Ongoing Past, Unlikely to Return 
##                       35                     1106                       28</code></pre>
<div class="alert alert-info">
<p><strong>Exercise:</strong></p>
<p>Explore the threats table. For example,</p>
<ul>
<li>Pick a species and identify which threats are causing rapid declines
and slow declines.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="mapping-hotspots-of-threatened-species" class="section level1"
number="2">
<h1><span class="header-section-number">2</span> Mapping hotspots of
threatened species</h1>
<p>Next, we analyse the distribution of threatened species. To do so, we
combine the red list status information with the distribution data.
Specifically, we extract all species that belong to a specific threat
category and then compute the species richness of these species per cell
and map this.</p>
<p>For example, we can extract all species that are classified as
vulnerable:</p>
<pre class="r"><code>(subset(redlist_status,category==&#39;VU&#39;)$scientific_name)</code></pre>
<pre><code>##  [1] &quot;Ammotragus lervia&quot;        &quot;Arvicola sapidus&quot;        
##  [3] &quot;Dinaromys bogdanovi&quot;      &quot;Gazella cuvieri&quot;         
##  [5] &quot;Gazella dorcas&quot;           &quot;Gazella subgutturosa&quot;    
##  [7] &quot;Lepus castroviejoi&quot;       &quot;Lepus corsicanus&quot;        
##  [9] &quot;Mesocricetus auratus&quot;     &quot;Miniopterus schreibersii&quot;
## [11] &quot;Myomimus roachi&quot;          &quot;Myotis capaccinii&quot;       
## [13] &quot;Nyctalus lasiopterus&quot;     &quot;Panthera pardus&quot;         
## [15] &quot;Plecotus sardus&quot;          &quot;Rangifer tarandus&quot;       
## [17] &quot;Rhinolophus mehelyi&quot;      &quot;Spalax graecus&quot;          
## [19] &quot;Spalax zemni&quot;             &quot;Ursus maritimus&quot;         
## [21] &quot;Vormela peregusna&quot;</code></pre>
<p>Using the red list information we can then map spatial hotspots of
species wit, meaning the species richness of species falling into this
red list category.</p>
<pre class="r"><code>library(raster)

# Identify all vulnerable species 
vu_spp &lt;- subset(redlist_status,category==&#39;VU&#39;)$scientific_name

# Identify all least concern species
lc_spp &lt;- subset(redlist_status,category==&#39;LC&#39;)$scientific_name

# Now, we extract the distribution data for the VU and LC species groups, make rasters, stack these and plot
# Calculate species richness
richness_RL_status &lt;- data.frame(r_mammals_eur$Presence_and_Absence_Matrix[,1:2],
  richness_vu = rowSums(r_mammals_eur$Presence_and_Absence_Matrix[,vu_spp]),
  richness_lc = rowSums(r_mammals_eur$Presence_and_Absence_Matrix[,lc_spp]))

# Make raster and plot
spplot( rasterFromXYZ(richness_RL_status))</code></pre>
<p><img src="3_ThreatData_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="alert alert-info">
<p><strong>Exercise:</strong></p>
<p>Map species richness of all species belonging to the threatened
categories (CR, EN, VU) and species richness of all species belonging to
the non-threatened categories (NT, LC).</p>
<ul>
<li>Discuss the patterns. Where are hotspots of threatened species?</li>
</ul>
</div>
</div>
<div id="mapping-hotspots-of-threats" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Mapping hotspots of
threats</h1>
<p>We can also analyse the spatial distribution of threats. To do so, we
need to extract the species that are affected by a particular threat in
a particular time period. Then we can extract the distribution data for
these species, compute the species richness and map this in space.</p>
<pre class="r"><code># Which ongoing threats are the most common ?
sort(table(subset(redlist_threats, species %in% names_mammals_eur &amp; timing==&#39;Ongoing&#39;)$title), decreasing=T)[1:10]</code></pre>
<pre><code>## 
##  Hunting &amp; trapping terrestrial animals     Annual &amp; perennial non-timber crops 
##                                      80                                      66 
##            Livestock farming &amp; ranching Intentional use (species is the target) 
##                                      59                                      48 
##                   Agro-industry farming               Logging &amp; wood harvesting 
##                                      40                                      38 
##                     Persecution/control                Scale Unknown/Unrecorded 
##                                      36                                      35 
##                 Type Unknown/Unrecorded                   Housing &amp; urban areas 
##                                      35                                      34</code></pre>
<pre class="r"><code># Identify the species experiencing threats from hunting
mammals_threat1 &lt;- subset(redlist_threats,title==&quot;Hunting &amp; trapping terrestrial animals&quot; &amp; species %in% names_mammals_eur)$species
# Identify the species experiencing threats from agriculture, specifically non-timber crops 
mammals_threat2 &lt;- subset(redlist_threats,title==&quot;Annual &amp; perennial non-timber crops&quot; &amp; species %in% names_mammals_eur)$species

# Map species experiencing threats from hunting
plot(rasterFromXYZ(
  data.frame(
    r_mammals_eur$Presence_and_Absence_Matrix[,1:2],
    rowSums(r_mammals_eur$Presence_and_Absence_Matrix[,mammals_threat1]))), 
  main=&quot;Hunting &amp; trapping terrestrial animals&quot;)</code></pre>
<p><img src="3_ThreatData_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># species experiencing threats from agriculture, specifically non-timber crops 
plot(rasterFromXYZ(
  data.frame(
    r_mammals_eur$Presence_and_Absence_Matrix[,1:2],
    rowSums(r_mammals_eur$Presence_and_Absence_Matrix[,mammals_threat2]))), 
  main=&quot;Annual &amp; perennial non-timber crops&quot;)</code></pre>
<p><img src="3_ThreatData_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<div class="alert alert-info">
<p><strong>Exercise:</strong></p>
<ul>
<li>Pick two other ongoing threats and map the species richness of those
mammals affected by these threats.</li>
<li>Pick a future and a past threat and map the species richness of
those mammals affected by these threats.</li>
</ul>
<p>Interpret.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-IUCN2012" class="csl-entry">
IUCN. 2012. <em>IUCN Red List Categories and Criteria: Version 3.1.</em>
Gland, Switzerland; Cambridge, UK: IUCN.
</div>
<div id="ref-IUCN2019" class="csl-entry">
———. 2019. <em>The <span>IUCN</span> Red List of Threatened Species.
Version 2019-2.</em> http://www.iucnredlist.org. Downloaded on 27
October 2019.
</div>
</div>
</div>

<!DOCTYPE html>
<html>

<br>
<hr />
<div id="footer">
<p>Damaris Zurell 2022 <a href="http://creativecommons.org/licenses/by/4.0/" >(CC BY 4.0)</a>.  </p>
</div>

</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
